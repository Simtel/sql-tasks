### Ключевые моменты SQL (Mysql)

## Содержание

[Отличия MyISAM и InnoDB](#Отличия-MyISAM-и-InnoDB)

[Объединение таблиц и выборок](#Объединение-таблиц-и-выборок)

### **Отличия MyISAM и InnoDB**

| Описание      | MyISAM        | InnoDB       |
| ------------- | ------------- | -------------
| Транзакции  | Нет  | Да |
| Внешние ключи  | Нет | Да |
| Блокировки | Блокирует всю таблицу | Блокирует только строку |
| Одновременные запросы к разным участкам таблицы (tests/different_areas.sql) | Медленее | Быстрее |
| При смешанной нагрузке в таблице (SELECT/UPDATE/DELETE/INSERT) | Медленее | Быстрее |
| Операция INSERT | Быстрее | Медленее |
| Если преобладают операции чтения | Быстрее | Медленее |
| Deadlock
| Deadlock — ситуация в многозадачной среде или СУБД, при которой несколько процессов находятся в состоянии бесконечного ожидания ресурсов, захваченных самими этими процессами.| Нет | Да |
| Запрос Count(*) (tests/count.sql) | Быстрее | Медленее |
|Размер занимаемого места на диске|Меньше|Больше (примерно в 1,5 раза)|
|Поведение в случае сбоя|Ломается вся таблица|Можно восстановить по логам транзакций|

### **Объединение таблиц и выборок**

*UNION* - оператор объединения наборов строк, возвращаемых SQL-запросами. Не имеет ограничения на количество запросов.

*JOIN* - оператор операции соединения таблиц. 

#### Union

|Union| Union ALL|
| ------------- | ------------- | 
| Одинаковые строки выводится не будут. | Покажет все строки включая дубликаты |

Требования для запросов в UNION:

* одинаковый набор колонок для выборки
* одинаковое количество выражений
* одинаковые типы данных колонок и
* одинаковый порядок колонок

#### Варианты JOIN:

**INNER JOIN** — возвращает записи, имеющиеся в обеих таблицах

**LEFT JOIN** — возвращает записи из левой таблицы, даже если такие записи отсутствуют в правой таблице

**RIGHT JOIN** — возвращает записи из правой таблицы, даже если такие записи отсутствуют в левой таблице

**FULL (OUTER) JOIN** — возвращает все записи объединяемых таблиц

**CROSS JOIN** — возвращает все возможные комбинации строк обеих таблиц

**SELF JOIN** — используется для объединения таблицы с самой собой